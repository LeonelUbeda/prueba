{"version":3,"sources":["../../../src/ServerComponents/GenerateSKU/GenerateSKU.js"],"names":["GenerateSKU","obj","Promise","resolve","reject","connection","CreateConnection","subcategoria","ID_subcategoria","marca","ID_marca","mysqlQuery","query","error","results","fields","sku","variante","parseInt","substring","varianteString","toString","subcategoriaString","marcaString","longitud","length","newSKU"],"mappings":";;;;;;;AAAA;;;;;;;;AAGA;;;;;;;AAOA,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAAEC,GAAF,EAAW;AAC7B,SAAO,IAAIC,OAAJ;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAa,iBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAClB,kBAAI;AAEF;AACMC,gBAAAA,UAHJ,GAGiBC,4BAHjB,EAIIC,YAJJ,GAImBN,GAAG,CAACO,eAJvB,EAKIC,KALJ,GAKYR,GAAG,CAACS,QALhB,EAMIC,UANJ,+DAMsEJ,YANtE,sDAM8HE,KAN9H,2CAQF;;AACAJ,gBAAAA,UAAU,CAACO,KAAX,CAAkBD,UAAlB,EAA8B,UAACE,KAAD,EAAQC,OAAR,EAAiBC,MAAjB,EAA4B;AACxD,sBAAIF,KAAJ,EAAW;AACTT,oBAAAA,MAAM,CAACS,KAAD,CAAN;AACD,mBAFD,MAGK;AAEH,wBAAIG,GAAG,GAAGF,OAAO,CAAC,CAAD,CAAP,CAAWE,GAArB;AAAA,wBACIC,QAAQ,GAAGC,QAAQ,CAACF,GAAG,CAACG,SAAJ,CAAc,CAAd,CAAD,CAAR,GAA6B,CAD5C;AAAA,wBAEIC,cAAc,GAAGH,QAAQ,CAACI,QAAT,EAFrB;AAAA,wBAGIC,kBAAkB,GAAGf,YAAY,CAACc,QAAb,EAHzB;AAAA,wBAIIE,WAAW,GAAGd,KAAK,CAACY,QAAN,EAJlB;AAAA,wBAKIG,QAAQ,GAAGJ,cAAc,CAACK,MAL9B,CAFG,CASC;;AACA,2BAAKD,QAAQ,GAAG,CAAhB,EAAmBA,QAAQ,EAA3B,EAA+B;AAC7BJ,sBAAAA,cAAc,GAAG,MAAMA,cAAvB;AACD;;AAEDI,oBAAAA,QAAQ,GAAGF,kBAAkB,CAACG,MAA9B,CAdD,CAgBC;;AACA,2BAAKD,QAAQ,GAAG,CAAhB,EAAmBA,QAAQ,EAA3B,EAA+B;AAC7BF,sBAAAA,kBAAkB,GAAG,MAAMA,kBAA3B;AACD;;AAEDE,oBAAAA,QAAQ,GAAGD,WAAW,CAACE,MAAvB,CArBD,CAuBC;;AACA,2BAAKD,QAAQ,GAAG,CAAhB,EAAmBA,QAAQ,EAA3B,EAA+B;AAC7BD,sBAAAA,WAAW,GAAG,MAAMA,WAApB;AACD;;AAED,wBAAMG,MAAM,aAAMJ,kBAAN,SAA2BC,WAA3B,SAAyCH,cAAzC,CAAZ,CA5BD,CA8BC;;AACAjB,oBAAAA,OAAO,CAACuB,MAAD,CAAP;AACL;AACF,iBArCD;AAsCD,eA/CD,CAgDA,OAAOb,KAAP,EAAc;AACZT,gBAAAA,MAAM,CAACS,KAAD,CAAN;AACD;;AAnDiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAb;;AAAA;AAAA;AAAA;AAAA,MAAP;AAqDD,CAtDD;;eAwDeb,W","sourcesContent":["import CreateConnection from './../CreateConnection/CreateConnection';\r\n\r\n\r\n/**\r\n * Generar un nuevo SKU.\r\n *\r\n * @param {Number} subcategoria  La subcategoria del producto.\r\n * @param {Number} marca  La marca del producto\r\n * @returns {String}\r\n */\r\nconst GenerateSKU = ( obj ) => {\r\n  return new Promise( async( resolve, reject ) => {\r\n    try {\r\n\r\n      //Crea el objeto para la conexiÃ³n e importa el schema\r\n      const connection = CreateConnection,\r\n            subcategoria = obj.ID_subcategoria,\r\n            marca = obj.ID_marca,\r\n            mysqlQuery = `select sku from producto where (ID_subcategoria = ${subcategoria} or ID_subcategoria = 0) and (ID_marca = ${marca} or ID_marca = 0) order by sku desc;`;\r\n\r\n      //Realiza la query. Si no hay error, resuelve con los resultados\r\n      connection.query( mysqlQuery, (error, results, fields) => {\r\n        if (error) {\r\n          reject(error);\r\n        }\r\n        else {\r\n\r\n          let sku = results[0].sku,\r\n              variante = parseInt(sku.substring(6)) + 1,\r\n              varianteString = variante.toString(),\r\n              subcategoriaString = subcategoria.toString(),\r\n              marcaString = marca.toString(),\r\n              longitud = varianteString.length;\r\n\r\n              // Hace que la variante nueva tenga 5 digitos\r\n              for(;longitud < 5; longitud++) {\r\n                varianteString = '0' + varianteString;\r\n              }\r\n\r\n              longitud = subcategoriaString.length;   \r\n              \r\n              //Hace que la subcategoria tenga 3 digitos\r\n              for(;longitud < 3; longitud++) {\r\n                subcategoriaString = '0' + subcategoriaString;\r\n              }\r\n\r\n              longitud = marcaString.length;   \r\n              \r\n              // Hace que la marca tenga 3 digitos\r\n              for(;longitud < 3; longitud++) {\r\n                marcaString = '0' + marcaString;\r\n              }\r\n\r\n              const newSKU = `${subcategoriaString}${marcaString}${varianteString}`\r\n\r\n              //retorna el resultado\r\n              resolve(newSKU);\r\n        }\r\n      });\r\n    }\r\n    catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n}\r\n\r\nexport default GenerateSKU;\r\n"],"file":"GenerateSKU.js"}